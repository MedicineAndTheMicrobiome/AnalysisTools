The analysis of two different sample types (e.g. OWSH and BAL, or BAL microbiome and BAL virome, etc.) from the same individual was performed using two different techniques based on the comparison of intersample distances.  Within each group of samples from the same sample type, a distance matrix was calculated based on the Manhattan distance between compositional profiles.  The samples from the two sample types were then hierarchically clustered independently with Ward’s Minimum Variance.  The two trees were then iteratively cut, yielding groups of clusters from 2 to maximum cuts, where maximum cuts=ceiling(log2(number of shared samples)).  Next a contingency table was calculated for each combination of cuts from the two sample types.  For example, 2 cuts for sample type A and 4 cuts from sample type B, would yield a 2x4 contingency table, where each cell represents the probability of a sample from a specific cluster in A being found in a specific cluster in B.  Chi-squared tests were calculated for each table and binomial tests were calculated for each cell to identify the cut combinations and individual cells where specific clusters between sample types could be associated.  Conditional probabilities were calculated to estimate the probability of predicting the presence of a sample in one of sample type A’s clusters, being found in a cluster of sample type B’s clusters, and vice versa.  The second analysis iteratively cuts the previously calculated hierarchical cluster and then performs Mantel correlation tests on subclusters between sample types to identify samples that may be related.  A significant correlation measured by the Mantel statistic (Spearman’s correlation coefficient between two distance matrices), indicates a relationship among the samples in one sample type may also be found in the other sample type.  Iteratively cutting the hierarchical clustering into subclusters may uncover inter-sample type relationships that only exist within some clusters.
